{% extends "base.html" %}
{% load python %}

{% block title %}Art Display{% endblock %}

{% block content %}
{% if artwork %}

<main>
  <h1 class="building-name">I-Center</h1>
  <div class="main">
    <section class="side-thing">
      <h2>Filter <span id="filter-extend">+</span></h2>
      <label for="floor">Floor</label>
      <!-- Add for loop to display floors, use if to change selected on option -->
      <select name="floor" id="floor" onchange="javascript:floorSelect(this)">
        <option value="1">1</option>
        <option value="2" selected>2</option>
        <option value="3">3</option>
        <option value="4">4</option>
      </select>
      <label for="building">Buildings</label>
      <select name="building" id="building" onchange="javascript:buildingSelect(this)">
        {% for name in building_names %}
        <option value="{{ 0|get_building_name:name.name }}"><a href="{{ request.path|change_building:name.name }}">{{ name.name }}</option></a>
        {% endfor %}
      </select>

      <!-- Ben: I make this script for you. It allows us to change the building we are in without changing the category.
      I'm sorry; I didn't mean to take your job. :) -Kyler -->
      <script type="text/javascript"> 
        function buildingSelect(elm) 
        { 
          let x = window.location.href
          let count = 0
          for (i= 0; i < x.length; i++) {
            if (x[i] == '/' && i > 7) {
              count++
              if (count == 1) { var firstSlash = i }
              else if (count == 2) { var secondSlash = i }  
            }
          }
          let building = x.substring(firstSlash + 1, secondSlash)
          x = x.replace(building, elm.value)
          window.location = x
        } 
        function floorSelect(elm) 
        { 
          let x = window.location.href
          let count = 0
          for (i= 0; i < x.length; i++) {
            if (x[i] == '/' && i > 7) {
              count++
              if (count == 3) { var thirdSlash = i }
            }
          }
          let floor = x.substring(thirdSlash, thirdSlash + 3)
          x = x.replace(floor, "/" + elm.value)
          window.location = x
          // TODO: This can be modified to allow it to change categories to all.
        } 
      </script> 

      <button class="filter-category-btn drop-btn">Categories +</button>
      <div class="filter-category">
        {% for category in category_names %}
            <a class="category" href="{{ request.path|building_change_category:category.name }}">{{ category.name }}</a>
        {% endfor %}
      </div>
    </section>
    <section class="card-grid art">
      {% for artworks in art_context %}
      <article class="card">
        <a class="card-a" href="{{ artworks.get_absolute_url }}">
          <img src="../../../media/{{ artworks.picture }}" alt="{{ artworks.picture }}">
        </a>
        <section class="card-body">
          <h2>{{ artworks.title }}</h2>
          <button class="category-btn drop-btn">Categories +</button>
          <div class="categories">
            {% for category in artworks.categories.all %}
            <!-- {% if category.name != "All" %} -->
            <!-- Does not display "All" category, that would not look good in my opinion -->
            <a class="category" href="{{ request.path|building_change_category:category.name }}">{{ category.name }}</a>
            <!-- {% endif %} -->
            {% endfor %}
          </div>
        </section>
        <section class="card-footer">
          <small>{{ artworks.artist_name }}</small>
        </section>
      </article>
      {% endfor %}
    </section>
  </div>
  <section class="small-filter">
    <h3>Filter</h3>
    <label for="floor">Floor</label>
    <select name="floor" id="floor">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select>
    <button class="small-filter-category-btn drop-btn">Categories +</button>
    <div class="small-filter-category">
      {% for category in category_names %}
      <a class="category" href="#">{{ category.name }}</a>
      {% endfor %}
    </div>
  </section>
  <button id="filter-btn">+</button>
</main>
{% else %}
<h1>No Artwork matching criteria.</h1>
{% endif %}

{% endblock %}